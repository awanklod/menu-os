#!/bin/bash

# Warna Terminal
GREEN='\033[0;32m'
RED='\033[0;31m'
YELLOW='\033[1;33m'
CYAN='\033[0;36m'
NC='\033[0m' # No Color

# Ambil Status Bot
status_kyt=$(systemctl is-active kyt)
status_cybervpn=$(systemctl is-active botrs)
status_sellvpn=$(systemctl is-active sellvpn)

# Fungsi Format Status
format_status() {
    [[ "$1" == "active" ]] && echo -e "${GREEN}ON${NC}" || echo -e "${RED}OFF${NC}"
}
status_bot_kyt=$(format_status "$status_kyt")
status_bot_cybervpn=$(format_status "$status_cybervpn")
status_bot_sellvpn=$(format_status "$status_sellvpn")

# Status Gabungan
if [[ "$status_kyt" == "running" || "$status_cybervpn" == "running" || "$status_sellvpn" == "online" ]]; then
    status_total="${GREEN}ON${NC}"
else
    status_total="${RED}OFF${NC}"
fi

# Info IP dan Tanggal Server
ipsaya=$(wget -qO- ipinfo.io/ip)
data_server=$(curl -s --insecure -v https://google.com/ 2>&1 | grep Date | sed -e 's/< Date: //')
date_list=$(date +"%Y-%m-%d" -d "$data_server")

# Tampilkan Menu
clear
echo -e "${YELLOW}-------------------------------------------------${NC}"
echo -e "               â€¢ ${CYAN}MENU BOT PANEL${NC} â€¢               "
echo -e "${YELLOW}-------------------------------------------------${NC}"
echo -e "IP Server           : ${CYAN}$ipsaya${NC}"
echo -e "Tanggal Server      : ${CYAN}$date_list${NC}"
echo -e "Status Semua Bot    : $status_total"
echo -e "${YELLOW}-------------------------------------------------${NC}"
echo -e "Bot Panel           : $status_bot_kyt"
echo -e "Bot Reseller        : $status_bot_cybervpn"
echo -e "Bot XWAN VPN        : $status_bot_sellvpn"
echo -e "${YELLOW}-------------------------------------------------${NC}"
echo -e "[${CYAN}1${NC}] Add Bot Panel"
echo -e "[${CYAN}2${NC}] Delete Bot Panel"
echo -e "[${CYAN}3${NC}] Stop Bot Panel"
echo -e "[${CYAN}4${NC}] Restart Bot Panel"
echo -e "[${CYAN}5${NC}] Add Bot Regis"
echo -e "[${CYAN}6${NC}] Add Bot Reseller"
echo -e "[${CYAN}7${NC}] Plugin Bot Seller XWAN VPN"
echo -e "[${CYAN}8${NC}] Bot Seller XWAN VPN"
echo -e "${YELLOW}-------------------------------------------------${NC}"
echo -e "[${RED}0${NC}] Back To Menu"
echo -e "${YELLOW}-------------------------------------------------${NC}"
echo ""

# Input Menu
read -p "Select menu: " opt
echo ""

# Eksekusi Pilihan
case $opt in
  1) clear; wget -q https://v4.serverpremium.web.id:81/os/bot/kyt.sh && chmod +x kyt.sh && ./kyt.sh ;;
  2) clear; hapus-bot ;;
  3) clear; stop-bot ;;
  4) clear; restart-bot ;;
  5) clear; bot2 ;;
  6) clear; wget https://raw.githubusercontent.com/kiryusekei/v7/main/botrs.sh && chmod +x botrs.sh && ./botrs.sh ;;
  7) clear; apt install dos2unix -y && wget https://v4.serverpremium.web.id:81/os/api.sh && chmod +x api.sh && dos2unix api.sh && ./api.sh;;
  8) clear;
     sysctl -w net.ipv6.conf.all.disable_ipv6=1 && sysctl -w net.ipv6.conf.default.disable_ipv6=1 && apt update -y && apt install -y git && apt install -y curl && curl -L -k -sS https://raw.githubusercontent.com/myridwan/BotVPN2/refs/heads/ipuk/start -o start && bash start sellvpn && [ $? -eq 0 ] && rm -f start;;
  *) clear; menu ;;
esac
